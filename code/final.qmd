---
title: "Final"
author: "Veronique Letourneau, Victoria Yang & Sundeep Rodricks"
date: "2023-06-16"
format:
  html:
    toc: true
    toc-location: left
    code-fold: true
    theme: yeti
editor: visual
execute:
  message: false
  warning: false
---

# Problem 1

## Intro

H~0~: There is no relationship between Kangaroo Rat Mound Location and total seed count.

H~A~: There is a relationship between Kangaroo Rat Mound Location and total seed count.

Significance level = 0.05

## Methods

## Results

#### Setting up

```{r}
library(here)
library(tidyverse)
library(utils)
library(readr)
library(janitor)
library(dplyr)
library(naniar)
library(ggplot2)
library(performance)
library(effsize)
library(rstatix)
```

Initial data wangling:

```{r prob-1-data}
  # reading in the data
kratseed <- read.csv("~/github/ENVS-193DS_final/data/knb-lter-sev.208.102459/sev208_kratseedbank_20120213.txt") %>% 
  # make the column names cleaner
  clean_names() %>%
  # renaming columns
  rename(c("location" = "loc", "seed_count" = "seeds")) %>% 
  # selecting the columns of interest
  select(location, seed_count) %>% 
  # renaming locations
  mutate(location = case_when(
    location == "B" ~ "Base of Mound", 
    location == "D" ~ "Surrounding Mound",
    location == "E" ~ "Edge of Mound",
    location == "I" ~ "Inter Space of Mound"))
```

Visualizing missing data:

```{r prob1-missing-data}
# visualizing missing data
gg_miss_var(kratseed) +
labs(title = "Missing Data Visualization of Mound Locations and Seed Count",
     caption = "Visualization shows no missing data for mound locations nor seed counts") +
  theme(plot.title = element_text(size = 10, hjust = 0.5)) +
  theme(plot.caption = element_text(size = 9, hjust=0.5))
```

Exploratory Visualization:

```{r prob1-exp-vis}
# plotting an exploratory visualization 
ggplot(data = kratseed, aes(x = location, y = seed_count)) +
  geom_jitter() +
  labs(title = "Exploratory Visualization of Seed Count Across Mound Locations ",
     caption = "Visualization shows the highest seed count 
     at the base of the mound and decreasing count further 
     from the mound") +
  theme(plot.title = element_text(size = 10, hjust = 0.5)) +
  theme(plot.caption = element_text(size = 8, hjust=0.5))
```

Visually checking for normality of variables and distribution with a histogram and QQ Plot:

```{r prob1-histogram}
# checking histogram for independence of variables and spread
histogram <- ggplot(data = kratseed, aes(x = seed_count)) +
  geom_histogram(bins = 20) +
  labs(x = "Seed Count", y = "Count") +
  theme_bw()
histogram
```

```{r prob1-qqplot}
# checking qq plot for normality
ggplot(data = kratseed) +
  stat_qq(aes(sample = seed_count)) +
  stat_qq_line(aes(sample = seed_count), color = "orange") +
  facet_wrap(~ location)
```

Using the Shapiro Wilk test to check for normal distribution:

```{r prob1-shapiro}
# The p-value of the Shapiro-Wilk Test is greater than 0.05. Meaning the data significantly deviates from a normal distribution.
shapiro.test(kratseed$seed_count)
```

The QQ plot shows that the sample distribution is not linear or normally spread. The histogram visualization shows that the distribution of the seed count data is not normally distributed. And the Shapiro-Wilk test (p-value \< 0.05) shows that the data deviates from a normal distribution as well. Therefore, a non-parametric alternative to a one-way ANOVA (Kruskal-Wallis test) is performed to compare the seed counts between rat mound locations.

```{r}
kruskal.test(seed_count ~ location, data = kratseed)
```

From the Kruskal-Wallis test, we can conclude that there are significant differences between the treatment groups because the p-value is less than the significance value of 0.05 (p-value = 6.738e-05). Multiple pairwise comparisons between groups were conducted and we know there is a substantial difference between groups based on the Kruskal-Wallis test's results, but we don't know which pairings of groups are different. The function pairwise.wilcox.test() can be used to calculate pairwise comparisons between group levels with different testing corrections.

```{r prob1-pairwise-wilcox}
# calculating pairwise comparisons between location
pairwise.wilcox.test(kratseed$seed_count, kratseed$location)
```

The results of the Pairwise Wilcox Test show that not all of the mound locations significantly differ in seed counts, but that the Inter-Space of the mound has a significant difference in seed count between all three other locations (p.value = 4.1e-05 when compared to the Base of the mound, 0.0056 with the Edge of the mound, and 0.0056 with the Surrounding of the mound).

Final Visualization of total seed count by Kangaroo Rat mound location:

```{r prob1-final-vis}
# visualization of total seed count by mound location
ggplot(data = kratseed, aes(x = location,y = seed_count)) +
# adding colors for mound locations
  geom_bar(stat = "identity", aes(fill = location)) +
  # change legend title
  scale_fill_discrete(name = "Mound Location") +
  theme_classic() +
  labs (x = "Mound Location", 
        y = "Total Seed Count", 
        title = "Total Seed Count by Kangaroo Rat Mound Location",
        caption = "Visualization of the total seed count in all four Kangaroo rat mound locations.") +
  theme(plot.title = element_text(size = 12, hjust = 0.5)) +
  theme(plot.caption = element_text(size = 7, hjust=0.5))
  text = element_text(family = "Times New Roman")
```

# Problem 2

1.  Read in packages

```{r}
# model packages
library(MASS)
library(lme4)
library(glmmTMB)

# diagnostics and model info
library(DHARMa)
library(MuMIn)
library(ggeffects)
library(lmtest)
library(broom)

# general usage
library(tidyverse)
library(skimr)
library(GGally)
library(flextable)

salamanders <- read_csv(here("data", "salamanders.csv"))
```

```{r prob-2-data}

# reading in seed counts data
seeds <- read_csv(here("data", "knb-lter-nwt.297.1", "shrubstudy_seed_ctwt.ms.data.csv")) %>%
  
  # select the columns of interest
  select(treatment, species, total_nr_infl, nr_seeds) %>% 
  
  # change variable names to be more descriptive
  mutate(treatment = case_when(
    treatment == "control" ~ "open",
    treatment == "shrub" ~ "shrub")) %>% 
  
  # rename columns for readability
  rename("num_inflorescences" = total_nr_infl, "num_seeds" = nr_seeds)

```

2.  Visualize missing data:

```{r}
gg_miss_var(seeds)
```

**Figure 1.** Number of missing values from the seeds data frame.

3.  Subsetting the data by dropping NAs:

    Since I took this data set from online, I do not know why there are NA values so for the purpose of this analysis, I will exclude them.

```{r}
seeds_subset <- seeds %>% 
  
  # drops rows with NA values in the num_seeds column
  drop_na(num_seeds) 
```

4.  Create a pairs plot to visualize the relationships between variables:

```{r}

seeds_subset %>% 
  
  # include all columns
  select(treatment:num_inflorescences) %>% 
  
  # create pairs plot
  ggpairs()
```

5.  Create general

## Intro

## Methods

## Results
